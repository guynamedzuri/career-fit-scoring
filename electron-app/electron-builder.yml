appId: com.career-fit-scoring.app
productName: 이력서 적합도 평가 시스템
copyright: Copyright Ⓒ 2016 LS Automotive Technologies. All rights reserved.

# 앱 소스는 app.asar로 패키징 (리소스 보호). electron-updater는 asarUnpack으로 풀어서 로드 안정화
asar: true
asarUnpack:
  - "node_modules/electron-updater/**/*"
  - "node_modules/builder-util-runtime/**/*"
  - "scripts/**/*"
compression: maximum  # 최대 압축

# 자동 업데이트 설정 (GitHub Releases 사용)
publish:
  provider: github
  owner: guynamedzuri  # GitHub 사용자명 또는 조직명
  repo: career-fit-scoring  # 저장소 이름
  # latest.yml 파일 생성을 위해 publish 설정 필요
  # 실제로 publish하지 않아도 latest.yml은 생성됨
  # electron-updater가 런타임에 이 설정을 읽어서 사용함

directories:
  output: dist-installer
  # buildResources: icon.ico 파일이 있는 디렉토리
  # build 디렉토리에 icon.ico가 있으므로 build로 설정
  # 또는 electron-app/icon.ico를 build/icon.ico로 복사
  buildResources: build

files:
  # 필수 파일들
  - electron/**/*
  - dist/**/*
  - package.json
  - "../.env"
  - "../certificate_official.txt"
  # icon.ico와 favicon.ico는 extraResources로 루트에 복사 (files는 resources/app에 감)
  # 모든 node_modules 포함
  - "node_modules/**/*"
  # career-fit-scoring 패키지 포함 (필수)
  - "../src/**/*.js"
  # career-fit-scoring 패키지의 빌드된 파일들 명시적 포함
  - "../node_modules/career-fit-scoring/**/*"
  # Python 스크립트 포함 (DOCX 파싱에 필요)
  - "../scripts/**/*.py"
  # 개발 도구 설정 파일만 제외
  - "!**/.vscode/**/*"
  - "!**/.idea/**/*"
  - "!**/.vs/**/*"
  - "!**/.editorconfig"
  - "!**/.eslintrc*"
  - "!**/.prettierrc*"
  - "!**/.gitignore"
  - "!**/.gitattributes"
  # TypeScript 설정 파일 제외 (이미 컴파일됨)
  - "!**/tsconfig*.json"
  - "!**/tsconfig*.ts"
  # TypeScript 소스 파일 제외 (이미 컴파일됨)
  - "!**/*.ts"
  - "!**/*.tsx"
  # 소스맵 제외
  - "!**/*.map"
  # 기타 불필요한 파일
  - "!**/*.{iml,o,hprof,orig,pyc,pyo,rbc,swp,csproj,sln,xproj}"
  - "!**/._*"
  - "!**/{.DS_Store,.git,.hg,.svn,CVS,RCS,SCCS}"
  - "!**/{__pycache__,thumbs.db,.flowconfig,.nyc_output}"
  - "!**/{appveyor.yml,.travis.yml,circle.yml}"
  - "!**/{npm-debug.log,yarn.lock,.yarn-integrity,.yarn-metadata.json}"
  # 빌드 관련 파일 제외
  - "!**/vite.config.*"
  - "!**/webpack.config.*"
  - "!**/rollup.config.*"

win:
  target:
    - target: nsis
      arch:
        - x64
  requestedExecutionLevel: requireAdministrator  # 시스템당 설치를 위해 관리자 권한 필요
  # 실행 파일(.exe) 아이콘 설정
  # 이 설정이 실제 앱 실행 파일의 아이콘을 결정함
  # buildResources 디렉토리(build) 기준 상대 경로
  # 문서: https://www.electron.build/configuration/win
  # "needs to be placed in the buildResources directory (defaults to build)"
  # 현재 buildResources: build 이므로 build/icon.ico를 사용
  # 참고: win.icon은 실행 파일 아이콘, nsis.installerIcon은 설치 프로그램 아이콘
  # win.icon은 buildResources 기준이므로 build/icon.ico가 아니라 icon.ico
  # buildResources: build 이므로 build/icon.ico는 build/build/icon.ico를 찾게 됨
  icon: icon.ico
  # 디버깅: 아이콘 파일 존재 여부 확인을 위해 로그 추가 필요
  # 아이콘 파일을 앱 루트에 복사하기 위한 설정
  # asar 사용 시 files는 app.asar에 들어가고, extraResources는 resources 루트에 복사
  extraResources:
    - from: icon.ico
      to: .
    # .env, certificate_official.txt → app.asar 안에 포함 (files). Node fs가 asar 안에서 읽을 수 있음.
    # scripts/*.py → asarUnpack으로 app.asar.unpacked에 풀림 (python.exe가 직접 읽어야 하므로)
    # Python embeddable 포함 (프로젝트 루트의 python-embed 폴더) - 실행 파일이라 extraResources 필수
    - from: ../python-embed
      to: python-embed
      filter:
        - "**/*"
    # Poppler Windows 바이너리 (pdftotext 등, ~20MB) - copy-poppler-for-build.js가 빌드 전에 ../poppler-windows → poppler-windows 로 복사
    - from: poppler-windows
      to: poppler-windows
      filter:
        - "bin/**"
  # 코드 서명 비활성화 (인증서 비용 절감)
  sign: null
  signAndEditExecutable: false
  # winCodeSign 다운로드 비활성화
  signingHashAlgorithms: []

nsis:
  oneClick: false  # 기본 installer: 설치 옵션을 물어봄
  perMachine: true  # 시스템당 설치 (모든 사용자)
  allowToChangeInstallationDirectory: true  # 설치 경로 변경 가능
  artifactName: "CareerFitScoring-Installer-${version}.${ext}"  # Installer 파일명 구분 (영문으로 변경)
  createDesktopShortcut: true
  createStartMenuShortcut: true
  shortcutName: 이력서 적합도 평가 시스템
  # 아이콘 설정: 새로운 256x256 ICO
  installerIcon: icon.ico
  uninstallerIcon: icon.ico
  installerHeaderIcon: icon.ico
  # shortcutIcon은 NSIS에서 지원되지 않음 - installer.nsh 스크립트로 처리
  deleteAppDataOnUninstall: false
  # 조용한 업데이트를 위한 설정
  runAfterFinish: false  # 설치 후 자동 실행 방지 (electron-updater가 처리)
  # NSIS 스크립트 커스터마이징 (현재 비활성화)
  # include: build/installer.nsh  # 바로가기 아이콘은 실행 파일 아이콘을 자동으로 사용

mac:
  target:
    - target: dmg
      arch:
        - x64
        - arm64
  category: public.app.business
  # macOS 아이콘 설정
  icon: icon.icns

linux:
  target:
    - target: AppImage
      arch:
        - x64
  category: Utility
  # Linux 아이콘 설정
  icon: icon.png
